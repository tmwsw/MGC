# Прогнозирование рыночных цен на арматуру

## Описание проекта

Данный проект направлен на разработку модели прогнозирования рыночных цен на арматуру для оптимизации закупок. Решение позволяет категорийному менеджеру строительной компании "Самолет" выбирать оптимальный объем тендера на основе предсказаний модели.

## Цель

Цель проекта - помочь категорийным менеджерам сэкономить, предоставляя обоснованные рекомендации по объемам закупок арматуры.

## Данные

Исторические данные о рыночных ценах на арматуру за период 2015-2023 гг. Данные разбиты на:

- `train.xlsx` – обучающий датасет.
- `test.xlsx` – тестовый датасет.
- Дополнительные данные, которые можно использовать в прогнозировании.

Важно: использование внешних данных запрещено.

## Методология

Для решения задачи использовались методы анализа временных рядов и машинного обучения. Основные этапы работы:

1. **Предобработка данных**: обработка пропущенных значений, генерация временных признаков, лагов и скользящих средних.
2. **Модель прогнозирования**: разработка модели на основе градиентного бустинга (CatBoost).
3. **Кросс-валидация**: для оценки устойчивости модели использовалась кросс-валидация.
4. **Прогнозирование**: предсказание будущих цен и рекомендация по объемам тендера.
5. **Разработка приложения**: интерфейс для категорийного менеджера, позволяющий легко получать прогноз и рекомендации.

## Используемые технологии

- Python
- Jupyter Notebook
- Pandas
- Scikit-learn
- CatBoost
- Метрики временных рядов

## Данные

Исторические данные о рыночных ценах на арматуру за период 2015-2023 гг. Данные разбиты на:

- `data/excel/sample_submission.xlsx` – пример выходного файла.
- `data/excel/test.xlsx` – тестовый датасет.
- `data/excel/train.xlsx` – обучающий датасет.
- `data/excel/Грузоперевозки.xlsx` – данные о логистике.
- `data/excel/Данные рынка стройматериалов.xlsx` – рыночные показатели.
- `data/excel/Макропоказатели.xlsx` – макроэкономические данные.
- `data/excel/Показатели рынка металла.xlsx` – показатели рынка металла.
- `data/excel/Топливо.xlsx` – данные по топливу.
- `data/excel/Цены на сырье.xlsx` – цены на сырье.
- `data/excel/CHMF Акции.csv` – данные по акциям CHMF.
- `data/excel/MAGN Акции.csv` – данные по акциям MAGN.
- `data/excel/NLMK Акции.csv` – данные по акциям NLMK.
- `data/excel/Индекс LME.xlsx` – данные по индексу LME.
- `combined.df` – объединенные данные для обучения модели.
- `predicted_procurement.xlsx` – результаты предсказания объема закупки.

## Структура репозитория

```
MGC/
│-- catboost_info/
│-- data/
│   │-- excel/
│   │   │-- sample_submission.xlsx
│   │   │-- test.xlsx
│   │   │-- train.xlsx
│   │   │-- Грузоперевозки.xlsx
│   │   │-- Данные рынка стройматериалов.xlsx
│   │   │-- Макропоказатели.xlsx
│   │   │-- Показатели рынка металла.xlsx
│   │   │-- Топливо.xlsx
│   │   │-- Цены на сырье.xlsx
│   │   │-- CHMF Акции.csv
│   │   │-- MAGN Акции.csv
│   │   │-- NLMK Акции.csv
│   │   │-- Индекс LME.xlsx
│-- other/
│-- analytics.ipynb
│-- analytics2.ipynb
│-- app.py  # Приложение для получения предсказаний
│-- catboost_model_Marin.ipynb  # Обучение CatBoost
│-- catboostmodel_Marin.cbm  # Сохраненная модель CatBoost
│-- main_Gorodetskaya.ipynb  # Альтернативная модель
│-- main.ipynb  # Основной ноутбук
│-- modal.ipynb  # Дополнительный анализ
│-- processing_data.ipynb  # Обработка данных
│-- random_forest_model.joblib  # Сохраненная модель Random Forest
│-- README.md  # Текущий файл
│-- requirements.txt  # Список зависимостей
│-- test_model.ipynb  # Тестирование модели
│-- xgboost_model.json  # Сохраненная модель XGBoost
```

## Метрики модели Catboost (Марин)

Оценка качества модели на тестовой выборке:

- **R²**: 0.9336
- **MAE**: 2155.2933
- **MSE**: 8706932.6960
- **RMSE**: 2950.7512


## Метрики модели Catboost (Городецкая)

- **R²**: 0.7063
- **MAE**: 5170.1104
- **MSE**: 38483443.2303
- **RMSE**: 6203.5025


## Метрики модели RandomForestRegressor (Симбирцев)

- **R²**: 0.92
- **MAE**: 2435.22
- **MSE**: 12601470.22
- **RMSE**: 3549.85


## Структура репозитория

- `main.ipynb` – ноутбук с кодом обучения модели.
- `main.ipynb` – ноутбук для предсказания объема закупки.
- `test.xlsx` – тестовый датасет с предсказаниями модели.
- `model.pkl` – сериализованная модель.
- `app/` – файлы приложения для категорийного менеджера.
- `README.md` – текущий файл с описанием проекта.

## Запуск проекта

1. Клонировать репозиторий:
   ```sh
   git clone https://github.com/tmwsw/MGC
   ```
2. Установить зависимости:
   ```sh
   pip install -r requirements.txt
   ```
3. Запустить `train.ipynb` для обучения модели.
4. Запустить `main.ipynb` для применения модели на тестовых данных.
5. Использовать приложение для получения прогнозов.

## Выводы

Модель позволяет предсказывать рыночные цены на арматуру и давать рекомендации по объему тендера. Однако, результаты показывают, что точность предсказаний ограничена, и дальнейшее улучшение модели возможно путем:

- Добавления новых инженерных признаков.
- Использования других архитектур моделей.
- Экспериментов с методами оптимизации.

## Контакты

Если у вас есть вопросы, предложения или замечания, свяжитесь со мной через [GitHub Issues](https://github.com/tmwsw/MGC/issues).
